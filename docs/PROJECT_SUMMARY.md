# TDX股票数据查询系统 - 项目总结

## 📋 项目概述

本项目是一个基于通达信(TDX)协议的股票数据获取和可视化系统，包含：
1. **核心库**：Go语言实现的通达信协议客户端
2. **Web应用**：现代化的股票数据查询界面

---

## 🎯 数据获取能力

### 1. 实时行情数据 (GetQuote)
- **五档报价**：买卖各5档价格和挂单量
- **实时指标**：最新价、涨跌幅、成交量、成交额
- **价格数据**：开盘、最高、最低、昨收
- **盘口数据**：内盘、外盘、活跃度

### 2. K线数据 (GetKline*)
支持多种周期的K线数据：

| 周期 | 方法 | 说明 |
|-----|------|------|
| 1分钟 | GetKlineMinuteAll | 最多24000条 |
| 5分钟 | GetKline5MinuteAll | 短期分析 |
| 15分钟 | GetKline15MinuteAll | 日内趋势 |
| 30分钟 | GetKline30MinuteAll | 波段参考 |
| 60分钟 | GetKlineHourAll | 短期趋势 |
| 日K | GetKlineDayAll | 中长期分析 |
| 周K | GetKlineWeekAll | 长期趋势 |
| 月K | GetKlineMonthAll | 超长期趋势 |
| 季K | GetKlineQuarterAll | 季度分析 |
| 年K | GetKlineYearAll | 年度分析 |

**K线数据包含**：
- 开盘价、收盘价、最高价、最低价
- 成交量、成交额
- 时间戳
- 昨收价（用于计算涨跌）

### 3. 分时数据 (GetMinute/GetHistoryMinute)
- **时间粒度**：每分钟一个数据点
- **交易时段**：9:30-11:30, 13:00-15:00（共240个数据点）
- **数据内容**：价格、成交量
- **适用场景**：当日走势分析、买卖点判断

### 4. 分时成交 (GetTrade*/GetHistoryTrade*)
- **数据类型**：逐笔成交记录
- **包含信息**：
  - 成交时间（精确到秒）
  - 成交价格
  - 成交量（手）
  - 买卖性质（0=买入，1=卖出，2=中性）
  - 成交单数
- **历史范围**：可查询至2000年6月9日
- **获取限制**：
  - 当日分时：最多1800条/次
  - 历史分时：最多2000条/次

### 5. 股票代码列表 (GetCode*/GetStockAll)
- **市场覆盖**：
  - 上海证券交易所 (SH)
  - 深圳证券交易所 (SZ)
  - 北京证券交易所 (BJ)
- **品种类型**：
  - A股
  - ETF基金
  - 指数
  - 其他证券

### 6. 指数数据 (GetIndex*)
- 支持所有周期的指数K线
- 包含涨跌家数统计
- 适用于大盘分析

---

## 🌐 Web应用功能

### 界面设计

#### 1. 搜索模块
- 支持股票代码搜索（如：000001）
- 支持股票名称模糊搜索（如：平安）
- 智能识别：6位数字直接查询，其他显示候选列表

#### 2. 数据展示模块

**基本信息卡片**
```
┌─────────────────────────────────────┐
│ 平安银行 (000001)                    │
├─────────────────────────────────────┤
│ 最新价: 12.50  涨跌额: +0.25       │
│ 涨跌幅: +2.04% 成交量: 123.5万手   │
│ 成交额: 15.6亿 开盘价: 12.30       │
│ 最高价: 12.60  最低价: 12.28       │
└─────────────────────────────────────┘
```

**五档行情视图**
```
┌────────────┬────────────┐
│   卖盘     │   买盘     │
├────────────┼────────────┤
│ 卖5 12.55  │ 买1 12.50  │
│ 卖4 12.54  │ 买2 12.49  │
│ 卖3 12.53  │ 买3 12.48  │
│ 卖2 12.52  │ 买4 12.47  │
│ 卖1 12.51  │ 买5 12.46  │
└────────────┴────────────┘
```

**K线图表**
- ECharts专业金融图表
- 蜡烛图 + 成交量柱状图
- 支持缩放、平移、数据提示
- 多周期切换（日/周/月/30分/15分/5分）

**分时走势图**
- 价格曲线 + 成交量柱状图
- 时间轴覆盖交易时段
- 渐变填充效果

**分时成交表**
- 表格形式展示逐笔数据
- 买入/卖出颜色区分
- 显示最近200笔交易

### 技术特点

#### 前端技术
- **纯原生开发**：HTML5 + CSS3 + JavaScript
- **图表库**：ECharts 5.4.3
- **响应式设计**：适配桌面和移动端
- **现代UI**：渐变色、阴影、动画效果
- **交互优化**：
  - 标签页切换
  - 加载指示器
  - 错误提示
  - 键盘快捷键（Enter搜索）

#### 后端技术
- **语言**：Go 1.20+
- **框架**：标准库 net/http
- **数据源**：通达信TDX库
- **API设计**：RESTful风格

---

## 📊 数据分类体系

### 按时间维度分类

| 类别 | 特点 | 应用场景 |
|-----|------|---------|
| **实时数据** | 3-5秒更新 | 盘中监控、快速决策 |
| **日内数据** | 分钟级历史 | 当日复盘、短线分析 |
| **日度数据** | 每日K线 | 波段操作、趋势判断 |
| **周月数据** | 周K/月K | 中长期投资 |

### 按数据类型分类

```
股票数据
│
├── 基本信息
│   ├── 代码
│   ├── 名称
│   └── 交易所
│
├── 价格数据
│   ├── 实时价格
│   ├── 历史价格(K线)
│   └── 分时价格
│
├── 成交数据
│   ├── 成交量
│   ├── 成交额
│   └── 逐笔成交
│
├── 盘口数据
│   ├── 五档买盘
│   ├── 五档卖盘
│   ├── 内外盘
│   └── 活跃度
│
└── 指标数据
    ├── 涨跌额
    ├── 涨跌幅
    ├── 换手率
    └── 量比
```

### 按市场分类

- **沪市股票** (SH)：600/601/603开头
- **深市主板** (SZ)：000开头
- **深市中小板** (SZ)：002开头
- **深市创业板** (SZ)：300开头
- **北交所** (BJ)：8字开头

---

## 🚀 快速开始

### 方式一：使用启动脚本（Windows）

```batch
cd web
start.bat
```

### 方式二：手动启动

```bash
# 1. 进入web目录
cd web

# 2. 运行服务器
go run server.go

# 3. 打开浏览器
# 访问 http://localhost:8080
```

### 方式三：Linux/Mac

```bash
cd web
chmod +x start.sh
./start.sh
```

---

## 📖 API接口文档

### 1. 获取五档行情
```http
GET /api/quote?code=000001
```

**响应示例**：
```json
{
  "code": 0,
  "message": "success",
  "data": [{
    "Exchange": 0,
    "Code": "000001",
    "K": {
      "Last": 12250,
      "Open": 12300,
      "High": 12600,
      "Low": 12280,
      "Close": 12500
    },
    "TotalHand": 1235000,
    "Amount": 156000000,
    "BuyLevel": [...],
    "SellLevel": [...]
  }]
}
```

### 2. 获取K线数据
```http
GET /api/kline?code=000001&type=day
```

**type参数**：
- `minute1`, `minute5`, `minute15`, `minute30`
- `hour`, `day`, `week`, `month`

**响应示例**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "Count": 100,
    "List": [{
      "Time": "2024-11-03T00:00:00Z",
      "Open": 12300,
      "Close": 12500,
      "High": 12600,
      "Low": 12280,
      "Volume": 1235000,
      "Amount": 156000000
    }]
  }
}
```

### 3. 获取分时数据
```http
GET /api/minute?code=000001&date=20241103
```

### 4. 获取分时成交
```http
GET /api/trade?code=000001&date=20241103
```

### 5. 搜索股票
```http
GET /api/search?keyword=平安
```

---

## 🎨 界面预览

### 主题色设计
- **主色调**：紫色渐变 (#667eea → #764ba2)
- **功能色**：
  - 上涨/买入：红色 #ef232a
  - 下跌/卖出：绿色 #14b143
  - 主要操作：蓝色 #1890ff
  - 警告：橙色 #faad14

### 视觉特效
- 渐变背景
- 卡片阴影
- 悬停动画
- 页面切换淡入效果
- 自定义滚动条

---

## 💡 使用场景示例

### 场景1：快速看盘
```
操作：输入"000001" → 查看基本信息
时间：3秒
获取：最新价、涨跌幅、成交量等关键指标
```

### 场景2：技术分析
```
操作：
1. 搜索股票
2. 切换到K线图
3. 选择日K线
4. 观察形态和趋势
5. 切换到30分钟K线
6. 寻找短期买卖点
```

### 场景3：盘口分析
```
操作：
1. 查看五档行情
2. 观察买卖盘力量对比
3. 查看分时成交
4. 分析大单行为
5. 结合分时图判断走势
```

### 场景4：历史回溯
```
操作：
1. 选择周K或月K
2. 查看长期趋势
3. 标记关键价格位
4. 制定投资策略
```

---

## ⚠️ 注意事项

### 数据限制
1. **实时性**：数据可能有3-5秒延迟
2. **历史范围**：
   - 分时成交：最早到2000年6月9日
   - K线数据：取决于股票上市时间
3. **单次查询**：
   - K线：最多800条
   - 分时成交：当日1800条，历史2000条

### 使用建议
1. 非交易时间无法获取实时分时数据
2. 建议在收盘后获取完整日K线数据
3. 频繁请求可能被服务器限制
4. 数据仅供参考，不构成投资建议

### 技术要求
- Go 1.20或更高版本
- 现代浏览器（Chrome/Firefox/Edge最新版）
- 稳定的网络连接

---

## 📂 项目结构

```
tdx-master/
├── client.go              # 客户端核心实现
├── protocol/              # 通达信协议实现
│   ├── model_quote.go     # 五档行情
│   ├── model_kline.go     # K线数据
│   ├── model_trade.go     # 分时成交
│   └── model_minute.go    # 分时数据
├── extend/                # 扩展功能
├── example/               # 示例代码
└── web/                   # Web应用
    ├── server.go          # Web服务器
    ├── static/            # 静态文件
    │   ├── index.html     # 主页面
    │   ├── style.css      # 样式表
    │   └── app.js         # 前端逻辑
    ├── README.md          # Web应用说明
    ├── USAGE.md           # 使用指南
    ├── start.bat          # Windows启动脚本
    └── start.sh           # Linux/Mac启动脚本
```

---

## 🔧 扩展开发

### 添加新的API接口

```go
// server.go
func handleNewFeature(w http.ResponseWriter, r *http.Request) {
    code := r.URL.Query().Get("code")
    
    // 调用TDX库
    data, err := client.SomeMethod(code)
    if err != nil {
        errorResponse(w, err.Error())
        return
    }
    
    successResponse(w, data)
}

// 注册路由
http.HandleFunc("/api/new-feature", handleNewFeature)
```

### 添加新的前端视图

```javascript
// app.js
async function loadNewFeature(code) {
    const response = await fetch(`/api/new-feature?code=${code}`);
    const result = await response.json();
    
    if (result.code === 0) {
        displayNewFeature(result.data);
    }
}

function displayNewFeature(data) {
    // 渲染数据到页面
}
```

---

## 📝 总结

### 核心优势
✅ 完整的股票数据获取能力  
✅ 现代化的可视化界面  
✅ 简单易用的API设计  
✅ 纯Go语言实现，性能优秀  
✅ 开箱即用，无需复杂配置  

### 适用人群
- 量化交易开发者
- 股票投资分析师
- 金融数据研究人员
- Go语言学习者
- 个人投资者

### 应用价值
- 快速原型开发
- 数据分析研究
- 投资决策辅助
- 学习交流展示

---

## 📞 技术支持

如有问题或建议，请查看：
- `README.md` - 项目基本说明
- `web/README.md` - Web应用详细文档
- `web/USAGE.md` - 详细使用指南

---

**最后更新**：2024年11月3日  
**版本**：v1.0.0  
**许可**：遵循原项目开源协议

