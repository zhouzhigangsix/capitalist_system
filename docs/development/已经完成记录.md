# 项目进度记录 - 智能选股系统 (Alpha Hunter)

**记录时间**: 2025-12-01 18:00
**当前状态**: ✅ 核心功能完成，量化评分系统上线，定时任务已配置

## 1. 项目概述
本项目是一个基于通达信协议的智能选股与行情分析系统。采用 Go 语言作为高性能数据网关和 Web 服务后端，Python 作为灵活的策略计算引擎，前端采用现代化的深色 UI 设计进行数据可视化展示。

## 2. 已完成功能

### 2.1 基础设施与部署
- [x] **Docker 化**：实现了完整的 Docker 容器化部署，基于 `golang:1.22-alpine` 构建，体积小巧。
- [x] **服务编排**：使用 `docker-compose` 管理服务，支持一键启动/停止。
- [x] **环境配置**：解决了 Docker 容器内的时区、权限、文件编码 (UTF-8) 等问题。

### 2.2 后端服务 (Go)
- [x] **行情 API**：提供实时行情、K线（日/周/月/分时）、分时成交等全套接口。
- [x] **数据持久化**：集成 `glebarez/go-sqlite`，支持读取 Python 策略生成的 SQLite 数据库。
- [x] **策略结果 API**：新增 `/api/strategy/results` 接口，支持按策略类型和日期查询选股结果。
- [x] **启动优化**：实现了通达信数据管理器的异步初始化，服务启动时间缩短至 1 秒内。
- [x] **Bug 修复**：修复了路由冲突 (`/api/tasks`) 导致的 Panic 问题。

### 2.3 策略引擎 (Python)
- [x] **B1 战法实现**：实现了基于"知行多空线"、KDJ、振幅、量比的复合选股策略 (`strategy_b1.py`)。
- [x] **量化评分系统**：新增100分制评分模型，综合评估5个维度（超卖程度30分、趋势强度25分、缩量程度20分、短期动能15分、振幅收敛10分）。
- [x] **评分详情展示**：数据库存储 `score`、`score_detail`、`trend_strength` 字段，前端可查看评分拆解。
- [x] **星级评价**：根据评分自动生成星级（90+:⭐⭐⭐⭐⭐, 80+:⭐⭐⭐⭐, 70+:⭐⭐⭐, 60+:⭐⭐, <60:⭐）。
- [x] **高性能计算**：使用 `ThreadPoolExecutor` 实现多线程并发拉取数据，大幅提升全市场扫描速度。
- [x] **数据存储**：自动将选股结果存储到 `stocks.db` SQLite 数据库，供后端读取。
- [x] **定时任务**：配置 crontab 每天15:13自动执行策略（收盘后），日志记录到 `/var/log/tdx-stock/`。

### 2.4 前端可视化
- [x] **全新 UI 设计**：设计了"深色极光 + 玻璃拟态" (Dark Aurora + Glassmorphism) 的高级 UI 主题。
- [x] **策略中心页面**：新建 `strategy.html`，支持：
    - 策略模型选择
    - 历史日期回溯
    - 结果表格展示（带涨跌色、量比热度标记）
    - 一键导出 CSV
- [x] **交互体验**：点击股票代码可直接跳转到 K 线详情页进行深度分析。

## 3. 操作指南

### 3.1 启动项目
在项目根目录下执行：
```bash
# 启动服务（后台运行）
docker-compose up -d

# 如果修改了代码，需要重新构建
docker-compose up -d --build
```

### 3.2 运行选股策略
策略脚本运行在宿主机（或可配置到容器中），目前建议在本地运行：
```bash
# 安装依赖
pip install requests pandas numpy

# 运行 B1 策略（默认分析所有股票）
python3 strategy_b1.py
```
*注：脚本运行完成后，会自动更新项目根目录下的 `stocks.db`，前端刷新即可看到最新结果。*

### 3.3 访问服务
- **策略中心（选股结果）**: [http://localhost:8080/strategy.html](http://localhost:8080/strategy.html)
- **行情首页**: [http://localhost:8080/index.html](http://localhost:8080/index.html)
- **API 健康检查**: [http://localhost:8080/api/health](http://localhost:8080/api/health)

### 3.4 停止项目
```bash
# 停止并移除容器
docker-compose down
```

## 4. 待完善/搁置计划
- [ ] **数据持久化优化**：恢复 `docker-compose.yml` 中 `data` 目录的挂载（需解决宿主机权限问题），避免每次重启重新下载代码表。
- [ ] **策略自动化**：将 Python 脚本集成到 Docker 容器中，并使用 Crontab 实现每日定时自动运行。
- [ ] **更多策略**：实现 N 型战法等其他选股策略。