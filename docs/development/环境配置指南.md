# 🔧 环境配置指南

## ⚠️ 当前问题

您的系统中Go命令不可用，需要先安装和配置Go环境。

---

## 📥 安装Go语言

### Windows系统安装步骤

#### 方法一：官方安装包（推荐）

1. **下载Go安装包**
   - 访问官网：https://golang.org/dl/
   - 或国内镜像：https://golang.google.cn/dl/
   - 选择最新版本的Windows安装包（如：go1.21.x.windows-amd64.msi）

2. **运行安装程序**
   - 双击下载的.msi文件
   - 按照向导完成安装
   - 默认安装路径：`C:\Program Files\Go`

3. **验证安装**
   打开新的PowerShell窗口，运行：
   ```powershell
   go version
   ```
   应该显示类似：`go version go1.21.x windows/amd64`

#### 方法二：使用Chocolatey（如果已安装）

```powershell
# 以管理员身份运行PowerShell
choco install golang
```

### 配置Go环境变量

安装完成后，Go会自动配置环境变量。如果未自动配置，手动设置：

1. **打开环境变量设置**
   - 右键"此电脑" → 属性 → 高级系统设置
   - 点击"环境变量"

2. **添加GOPATH（可选）**
   ```
   变量名：GOPATH
   变量值：C:\Users\你的用户名\go
   ```

3. **添加到PATH**
   在系统变量PATH中添加：
   ```
   C:\Program Files\Go\bin
   %GOPATH%\bin
   ```

4. **重启终端**
   关闭所有PowerShell窗口，重新打开

---

## ✅ 验证安装

### 1. 检查Go版本
```powershell
go version
```

### 2. 检查Go环境
```powershell
go env
```

应该能看到GOROOT、GOPATH等配置信息。

---

## 🚀 启动Web应用

### 确认环境后，按以下步骤操作：

#### 步骤1：安装项目依赖
```powershell
cd C:\Users\Administrator\Downloads\tdx-master
go mod tidy
```

#### 步骤2：进入web目录
```powershell
cd web
```

#### 步骤3：启动服务器
```powershell
go run server.go
```

#### 步骤4：打开浏览器
访问：http://localhost:8080

---

## 🔍 常见问题排查

### 问题1：go命令找不到
**症状**：
```
go : 无法将"go"项识别为 cmdlet、函数、脚本文件或可运行程序的名称
```

**解决方案**：
1. 确认Go已正确安装
2. 检查环境变量PATH中是否包含Go的bin目录
3. 重启终端或重启电脑
4. 以管理员身份运行PowerShell重新安装

### 问题2：模块下载失败
**症状**：
```
go: module xxx: Get "https://proxy.golang.org/...": dial tcp: i/o timeout
```

**解决方案 - 配置国内代理**：
```powershell
# 设置Go模块代理（国内）
go env -w GO111MODULE=on
go env -w GOPROXY=https://goproxy.cn,direct
```

### 问题3：端口被占用
**症状**：
```
listen tcp :8080: bind: Only one usage of each socket address is normally permitted
```

**解决方案**：
```powershell
# 查找占用8080端口的进程
netstat -ano | findstr :8080

# 结束进程（PID为查到的进程ID）
taskkill /PID <进程ID> /F

# 或者修改server.go中的端口号
```

### 问题4：防火墙阻止
**解决方案**：
1. Windows防火墙 → 允许应用通过防火墙
2. 添加go.exe到允许列表
3. 或临时关闭防火墙测试

---

## 📝 快速检查清单

在启动Web应用前，请确认：

- [ ] Go已安装（运行 `go version` 检查）
- [ ] 环境变量已配置
- [ ] 终端已重启
- [ ] 在项目根目录（tdx-master）
- [ ] 网络连接正常
- [ ] 8080端口未被占用

---

## 🎯 完整启动流程

### 方案A：命令行启动（推荐）

```powershell
# 1. 打开PowerShell
# 2. 进入项目目录
cd C:\Users\Administrator\Downloads\tdx-master

# 3. 下载依赖（首次运行）
go mod download

# 4. 进入web目录
cd web

# 5. 运行服务器
go run server.go

# 6. 看到以下提示表示成功：
# 成功连接到通达信服务器
# 服务启动成功，访问 http://localhost:8080

# 7. 打开浏览器访问
# http://localhost:8080
```

### 方案B：编译后运行

```powershell
# 1. 进入web目录
cd C:\Users\Administrator\Downloads\tdx-master\web

# 2. 编译程序
go build -o stock-web.exe server.go

# 3. 运行编译后的程序
.\stock-web.exe

# 优点：启动更快，可以分发给其他人使用
```

### 方案C：使用start.bat

在Go环境配置好之后：
```powershell
cd C:\Users\Administrator\Downloads\tdx-master\web
.\start.bat
```

---

## 💡 推荐配置

### 1. 设置Go模块代理（加速下载）
```powershell
go env -w GOPROXY=https://goproxy.cn,direct
go env -w GOPRIVATE=github.com
```

### 2. 启用Go模块
```powershell
go env -w GO111MODULE=on
```

### 3. 设置Go安装路径（可选）
```powershell
go env -w GOPATH=D:\Go
```

---

## 🔄 如果无法安装Go

### 替代方案：使用已编译版本

如果您无法安装Go环境，我可以为您提供：

1. **预编译的可执行文件**
   - 直接运行.exe文件
   - 无需Go环境
   - 跨平台支持

2. **Docker容器**
   - 使用Docker运行
   - 环境隔离
   - 一键启动

3. **在线演示**
   - 部署到云服务器
   - 浏览器直接访问
   - 无需本地环境

**需要这些方案吗？请告诉我！**

---

## 📞 获取帮助

### 确认当前状态
请运行以下命令并告诉我结果：

```powershell
# 1. 检查Go是否安装
go version

# 2. 检查Go环境
go env GOROOT
go env GOPATH
go env GOPROXY

# 3. 检查当前目录
pwd

# 4. 列出文件
ls
```

### 下一步操作

**如果Go已安装**：
- 重启PowerShell
- 运行上面的"完整启动流程"

**如果Go未安装**：
- 按照上面的"安装Go语言"步骤操作
- 或者选择"替代方案"

---

## 🎉 安装完成后

安装并配置好Go环境后，您就可以：

1. ✅ 运行Web应用
2. ✅ 查看股票数据
3. ✅ 体验所有功能
4. ✅ 进行二次开发

祝您顺利启动！如有问题随时反馈。

